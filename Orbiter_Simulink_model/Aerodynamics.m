% Aerodynamics

% Lift Force Coefficient
CL0 = -0.05 ; % CL_alpha_mach
CLalpha = 0.05; % CL_alpha_mach
CLdf = 0.003; % 0.003 Book
CLde = 0.02; % 0.02 Book 0.05
CLdsb = -0.0005; % 0
CLalphadot = 0; 
CLq = 0;

% Drag Force Coefficient
% CL0 = 0.2
CD0 = 0.019;
CDdf = 0; % CD_dbf LookedUp table
CDde = 0.02; % CD_de LookedUp table
CDda = 0; 
CDdr = 0;
CDdsb = 0.1;
CDalpha = [0.0007, -0.0016, 0.05]; % Mach = 0.25

% Side Force Coefficient
CYbeta = -0.02;
CYda = 0.003;
CYdr = -0.00002;
CYp = 0;
CYr = 0;

% Pitch Moment Coefficient
Cm0 = 0.036;
Cma = -0.012;
Cmdf = -0.0017;
Cmde = -0.087;
Cmdsb = 0.006;
Cmq = 0.058;
Cmalphadot = -10; % -10; % ???
t_1_2 = 5; % time to damp to one-half amplitude, [sec]

% Roll Moment Coefficient
Clbeta = -0.001; % LookedUp Table
Clda = 0.0001; %[-0.000004 0.00003 0.0039];
Cldr = 0.00002; %[-0.0000008 0.000005 0.0008];
Cldsb = 0.000008; % [0.000008 0.0002]
Clp = -0.003; % -0.15;
Clr = 0.006; % 0.0015; %[0.006 - 0.27];

% Yaw Moment Coefficient
Cnbeta = 0.0016; % Sideslip derivative
Cnda = 0.00005; % Roll control derivative
Cndr = 0.000006; % Yaw control derivative
Cndsb = 0; % 0.007;
Cnp = -0.0046; % Roll rate derivative
Cnr = -0.005; % -0.3; % Yaw rate derivative


% CL LookedUp Table
%CL(alpha, deg) coeff M = 5.0
CL_alpha = [  -4.0000         0    5.0000   10.0000   15.0000   20.0000   25.0000   30.0000   35.0000   40.0000   44.0000
             -0.1300   -0.0600    0.0450    0.1500    0.2800    0.4200    0.5700    0.7200    0.8700    0.9800    1.0400];

% EFFECT OF ELEVON DEFLECTION ON DIRECTIONAL STABILITY (elev, deg) M = 0.6, a = 5 deg
C_n_beta = [ -30.0000  -25.0000  -20.0000  -15.0000  -10.0000   -5.0000         0    5.0000   10.0000   15.0000   20.0000
              -0.0010   -0.0008   -0.0006   -0.0004   -0.0003   -0.0001         0    0.0002    0.0003    0.0002    0.0001];
          
% EFFECT OF ELEVON DEFLECTION ON ROLL DUE TO SIDESLIP (elev, deg) M = 0.6, a = 5 deg         
C_l_beta_da = [  -30.0000  -20.0000  -15.0000  -10.0000   -6.0000   -4.0000   -2.0000         0    2.0000    4.0000    6.0000   10.0000
            0.0010    0.0006    0.0004    0.0002    0.0001    0.0001    0.0000         0    0.0000    0.0000    0.0001    0.0003];
        
% EFFECT OF ELEVON DEFLECTION ON Aileron Roll Derivative (elev, deg) M = 0.6, a = 5 deg 
C_l_de_da = [-30.0000  -25.0000  -20.0000  -15.0000  -10.0000   -5.0000         0    4.0000   10.0000   15.0000
               0.0006    0.0006    0.0009    0.0022    0.0035    0.0040    0.0043    0.0042    0.0042    0.0040];
          
% EFFECT OF ELEVON DEFLECTION ON AILERON YAW DERIVATIVE, (elev, deg) M = 0.6, a = 5 deg 
Cnomega_a = [ -30.0000  -20.0000  -15.0000  -10.0000   -5.0000         0    5.0000   10.0000   14.5000
                0.0010    0.0015    0.0015    0.0014    0.0012    0.0010    0.0008    0.0004         0];
            

%          BASIC AXIAL FORCE COEFFICIENT

alpha_Cl = [-10 -5 -2.5 0 2.5 5 7.5 10 12.5 15 17.5 20 22.5 25];

Mach_Cl = [0.25	0.4	0.6	0.8	0.85 0.9];

Cl = [0.0252	0.0292	0.0412	0.0649	0.074	0.0881
      0.0561	0.057	0.0594	0.0706	0.0778	0.0877
      0.065     0.0655	0.0676	0.0748	0.0801	0.0898
      0.0574	0.0661	0.0702	0.0763	0.081	0.0907
      0.0641	0.0647	0.0669	0.0728	0.0782	0.0899
      0.0549	0.0555	0.0576	0.065	0.072	0.0875
      0.0411	0.042	0.0439	0.0578	0.0674	0.0841
      0.0243	0.0252	0.0272	0.0528	0.065	0.0817
      0.0067	0.0073	0.0118	0.0518	0.0659	0.0824
     -0.0121    -0.011	0.0073	0.0535	0.0678	0.0846
     -0.03      -0.0282	0.0134	0.0563	0.0704	0.0871
     -0.0423	-0.0403	0.0162	0.0597	0.0737	0.0899
     -0.0465	-0.0453	0.0162	0.0637	0.0776	0.0927
     -0.0478	-0.045	0.0152	0.068	0.0819	0.0957];

%  EFFECT OF ELEVON, Clde, Mach = 0.25
Clde = [0.07752	0.07697	0.0795	0.08361	0.08835	0.08598	0.08381	0.08947
        0.0646	0.0632	0.067	0.07258	0.07751	0.08083	0.06949	0.07335
        0.05125	0.05009	0.054	0.06127	0.0661	0.07541	0.05696	0.07373
        0.03425	0.03539	0.041	0.04936	0.05567	0.06625	0.05295	0.05393
        0.0171	0.01997	0.029	0.03575	0.04536	0.05495	0.02752	0.03975
        0.00461	0.0085	0.017	0.02164	0.02724	0.02959	0.00911	0.02563
       -0.00197 0.0009	0.007	0.00629	0.01057	0.01395	-0.00066 0.00507
       -0.00633 -0.00057 0.002	0.00157	0.00323	0.00798	-0.00555 0.00393
        0       0       0   	0   	0   	0       0       0
        0.00731 0.00412	0.004	0.0013	-0.00248 -0.00346 0.00823 0.00791
        0.01423	0.01448	0.012	0.00688	0.0035	0.00164	0.01942	0.01917
        0.02962	0.02839	0.023	0.01787	0.01527	0.01576	0.03446	0.03844
        0.05095	0.04224	0.042	0.03757	0.04031	0.04069	0.05373	0.05758];
    
% ------------------------Lift force coeff------------------------------

% Basic lift force coeff
CL_alpha_mach = [-0.5028	-0.51097	-0.52957	-0.58454	-0.59773	-0.61005	-0.62831	-0.65514	-0.65616
                -0.25906	-0.27397	-0.2887	-0.32751	-0.3379	-0.34601	-0.35039	-0.35897	-0.36172
                -0.15202	-0.16199	-0.17186	-0.19155	-0.19632	-0.20588	-0.21553	-0.21465	-0.19388
                -0.05	-0.05	-0.055	-0.065	-0.062	-0.06	-0.06	-0.06	-0.055
                0.06214	0.06212	0.07201	0.06176	0.06652	0.07101	0.07563	0.06498	0.09414
                0.17453	0.1744	0.17928	0.18859	0.19295	0.20356	0.21579	0.23947	0.24762
                0.29705	0.29691	0.30657	0.31963	0.31838	0.32413	0.34997	0.38783	0.38955
                0.4044	0.40924	0.41674	0.44384	0.44172	0.44572	0.4769	0.51887	0.52899
                0.51599	0.52757	0.54905	0.5648	0.56566	0.56794	0.56585	0.6466	0.66026
                0.53591	0.65002	0.67429	0.68162	0.57309	0.68323	0.70567	0.75535	0.77783
                0.77676	0.78385	0.79709	0.79087	0.77995	0.79401	0.81577	0.86501	0.89069
                0.91657	0.92529	0.92851	0.9578	0.8769	0.89485	0.91619	0.96429	0.99605
                1.00634	1.01512	1.01007	0.93184	0.91266	0.92074	0.9599	1.00227	1.04637
                1.09954	1.08946	1.04489	0.92289	0.90795	0.93837	0.96751	1.02232	1.07579];

    
% -------------------------Drag force coeff-----------------------------

% BACISdrag

CD_alpha_mach = [0.11425	0.11975	0.13521	0.16
                0.07935	0.08119	0.02489	0.09
                0.0717	0.07263	0.07517	0.062
                0.0624	0.0661	0.0702	0.0753
                0.06687	0.05747	0.07011	0.07557
                0.07339	0.07096	0.0735	0.02
                0.08056	0.06145	0.08	0.1
                0.09599	0.097	0.10146	0.13
                0.12125	0.12444	0.133	0.17827
                0.15734	0.16278	0.18822	0.23303
                0.2134	0.21	0.26537	0.30939
                0.2936	0.29	0.35519	0.38957
                0.36551	0.37144	0.43592	0.45
                0.45537	0.579	0.5	0.50539];


% Elevon drag coefficient incement    
CD_de = [0.1526	0.113	0.0796	0.0499	0.0176	-0.0262	-0.0837	-0.1391
        0.1356	0.098	0.067	0.039	0.008	-0.031	-0.1044	-0.1537
        0.1187	0.083	0.054	0.029	-0.002	-0.035	-0.117	-0.1546
        0.0968	0.067	0.041	0.017	-0.011	-0.041	-0.122	-0.1438
        0.0783	0.049	0.028	0.005	-0.019	-0.046	-0.1163	-0.1254
        0.0567	0.034	0.017	-0.004	-0.024	-0.046	-0.099	-0.1055
        0.0345	0.019	0.007	-0.009	-0.024	-0.037	-0.0724	-0.083
        0.0173	0.008	0.002	-0.007	-0.014	-0.018	-0.0423	-0.0423
        0       0       0        0  	0   	0   	0   	0
        -0.0095	-0.004	0.004	0.009	0.013	0.02	0.0397	0.0423
        -0.0191	-0.002	0.012	0.023	0.036	0.051	0.084	0.0911
        -0.02	0.004	0.023	0.042	0.064	0.09	0.1324	0.1492
        -0.0165	0.015	0.042	0.07	0.106	0.141	0.1853	0.2082];

% BodyFlap drag coefficient incement       
CD_dbf = [0.0135	0.00959	0.0059	0.00242	-0.0005	0.00005	0.0006	0.0006
        0.00442	0.00306	0.0017	0.00025	-0.00108	-0.00125	-0.00146	-0.00146
        0       0   	0       0   	0           0            0         0
        0	-0.00116	-0.0005	0.00079	0.00211	0.00294	0.00379	0.00379
        0	-0.00083	0.00013	0.00268	0.00538	0.00769	0.01004	0.01004
        0	0.00072	0.003	0.00737	0.0122	0.01735	0.0225	0.0223
        0	0.0033	0.0082	0.01499	0.0229	0.0316	0.0404	0.0404];
    
% ---------------Side force coeff----------------------------------------

ElevatorPreLookeUp = [-40 -35 -30 -25 -20 -15 -10 -5 0 5 10 15 20]; % positive down

AlphaPreLookedUp = [-10 -5 0 5 10 15 20 25]; % Alpha preLookedUp for controls

% Side force effect of aileron
CY_da = [0.00106	0.00048 	-0.00002	-0.0005     -0.0008 	-0.00102	-0.00116	-0.0014     -0.00125
        0.00035 	-0.00029	-0.00077	-0.0013     -0.00162	-0.00183	-0.00193	-0.00236	-0.00211
        -0.0004     -0.001      -0.00147	-0.00363	-0.00242	-0.00268	-0.00299	-0.0035     -0.0032
        -0.00122	-0.0017     -0.00302	-0.00352	-0.00322	-0.00376	-0.0041     -0.00452	-0.0043
        -0.0019     -0.00205	-0.00242	-0.003      -0.0033     -0.00442	-0.00492	-0.0052     -0.0049
        -0.0025     -0.0028     -0.0031     -0.00349	-0.0039     -0.00444	-0.00478	-0.0051     -0.0045
        -0.00298	-0.0031     -0.0033     -0.0034     -0.004      -0.00412	-0.0042     -0.0041     -0.00375
        -0.00265	-0.0027     -0.0032     -0.00345	-0.0036     -0.00372	-0.0038     -0.0033     -0.0027
        -0.00128	-0.0022     -0.003      -0.0035     -0.0036     -0.00372	-0.0036     -0.0035     -0.0025
        -0.00099	-0.0021     -0.003      -0.0035     -0.003      -0.00372	-0.0036     -0.0035     -0.0025];

% Side force effect of elevon
 CY_de = [  -0.0004	0        0.0004	0.00096	0.0012	0.00111	0.0007	0.00045
            -0.0004	0       0.0004	0.00096	0.0012	0.00111	0.0007	0.00045
            -0.0005	-0.0001	0.0003	0.00085	0.0011	0.00105	0.00073	0.0005
            -0.0006	-0.0002	0.0002	0.00074	0.001	0.00099	0.0007	0.00055
            -0.0007	-0.0003	0.0001	0.00065	0.0009	0.00065	0.0005	0.0003
            -0.0006	-0.0003	0       0.00041	0.0006	0.00056	0.0003	0.00015
            0       0   	0   	0   	0   	0   	0   	0
            -0.0011	-0.00095	-0.0008	-0.0006	-0.0005	-0.0005	-0.0005	-0.00065
            -0.0023	-0.00255	-0.0022	-0.00172	-0.0015	-0.00152	-0.0018	-0.00195
            -0.0063	-0.00545	-0.006	-0.00344	-0.0029	-0.00299	-0.0037	-0.0041];   

% Side force rudder effect    
CY_dr = [   0.00315	0.0031	0.003	0.0029	0.00275	0.00262	0.0026	0.0026
            0.0033	0.00324	0.00312	0.00305	0.00291	0.0029	0.00277	0.00279
            0.00339	0.0033	0.0032	0.00311	0.00301	0.00291	0.00289	0.00299
            0.0034	0.0033	0.0032	0.0031	0.003	0.00291	0.0029	0.0029
            0.00317	0.00311	0.00302	0.00285	0.00271	0.00262	0.00252	0.00265
            0.00293	0.00233	0.00279	0.00258	0.00235	0.00229	0.00233	0.00237
            0.0027	0.00255	0.00255	0.00232	0.00205	0.002	0.00205	0.0021
            0.00236	0.00229	0.00217	0.00195	0.00169	0.00162	0.00165	0.00169
            0.00199	0.00135	0.0017	0.00155	0.00138	0.00125	0.0012	0.0012];
    
% Side force effect of speed brake
CY_dsb = [  0.00015 0.00007 0.00015 0.0004 0.0008	0.00133	0.002	0.0026
            0.00014	0.0001	0.00014	0.00026	0.00044	0.00068	0.00039	0.00125
            0       0   	0   	0   	0   	0   	0   	0
            0.00027	0.00025	0.00057	0.00032	0.00037	0.00031	0.00017	0.00007
            0.00091	0.00087	0.00031	0.00106	0.00121	0.00097	0.00046	0.00009
            0.00145	0.00142	0.00145	0.00157	0.0017	0.00134	0.00065	0.00013
            0.00203	0.00202	0.00203	0.00205	0.00208	0.0016	0.00078	0.00013
            0.00235	0.00233	0.00235	0.00232	0.002	0.00157	0.00055	0.00013];
    
% Roll moment coeff
% Basic rolling moment coeff
Cl_beta = [  0	0	0	0	0	0	0	0
            0.00073	0.00001	-0.00073	-0.00147	-0.00239	-0.00223	-0.00181	-0.00139
            0.0014	-0.00003	-0.0015	-0.003	-0.0048	-0.0049	-0.0042	-0.0035
            0.00245	-0.00025	-0.00313	-0.00617	-0.00965	-0.01245	-0.0119	-0.01135
            0.0035	-0.00063	-0.005	-0.005	-0.0146	-0.02	-0.0196	-0.0192
            0.00507	-0.0013	-0.00746	-0.01342	-0.01972	-0.02639	-0.02486	-0.02334
            0.007	-0.0022	-0.0104	-0.0176	-0.025	-0.032	-0.0295	-0.025];

%  ------Pitcing moment coeff--------
% basic pitchin mometn coeff
Cm_alpha_mach = [0.032	0.034	0.04	0.059	0.068	0.09	0.101	0.1226	0.14
                0.03	0.032	0.0365	0.049	0.054	0.061	0.067	0.082	0.058
                0.029	0.0305	0.0347	0.0445	0.047	0.045	0.053	0.062	0.078
                0.028	0.029	0.033	0.04	0.04	0.035	0.038	0.042	0.055
                0.027	0.0275	0.0305	0.036	0.038	0.025	0.022	0.02	0.031
                0.026	0.026	0.029	0.0315	0.032	0.0225	0.016	0	0.005
                0.024	0.024	0.024	0.0225	0.022	0.02	0.012	-0.015	-0.015
                0.023	0.022	0.0205	0.018	0.017	0.015	0.004	-0.027	-0.03
                0.023	0.0225	0.021	0.017	0.012	0.0075	-0.006	-0.04	-0.042
                0.024	0.022	0.016	0.006	0.0005	-0.0025	-0.018	-0.05	-0.052
                0.019	0.016	0.009	-0.006	-0.011	-0.01	-0.028	-0.0555	-0.063
                0.014	0.008	-0.004	-0.005	-0.01	-0.003	-0.03	-0.06	-0.072
                0.0105	0.01	0.006	0.0026	0.02	0.02	-0.012	-0.035	-0.047
                0.01	0.012	0.033	0.08	0.09	0.09	0.087	0.07	0.02];

disp('Aerodynamics loaded');